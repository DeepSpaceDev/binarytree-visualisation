<dom-module id="binary-node">
  <template>
    <style>
      :host {
        display: inline-block;
        box-sizing: border-box;
      }
    </style>
    <canvas id="node" width="50" height="50"></canvas>
  </template>
  <script>
    Polymer({
      is: 'binary-node',

      properties: {
        value: {
          value: '',
          left: {
            type: Boolean,
            value: false
          },
          right: {
            type: Boolean,
            value: false
          }
        }
      },

      listeners: {
        'click': '_handleClick'
      },

      _handleClick: function (e) {
        var x = e.offsetX;
        var y = e.offsetY;

        var leftXMin = 6;
        var leftXMax = 16;
        var rightXMin = 34;
        var rightXMax = 44;

        var yMin = 34;
        var yMax = 44;

        if(y > yMin && y < yMax) {
          if(x > leftXMin && x < leftXMax && !this.left) {
            this.fire('addChild', {
              right: false,
              left: true
            });
          }
          if(x > rightXMin && x < rightXMax  && !this.right) {
            this.fire('addChild', {
              right: true,
              left: false
            });
          }
        }
      },

      attached: function () {
        var ctx = this.$.node.getContext('2d');

        ctx.beginPath();
        ctx.arc(25, 25, 15, 0, 2 * Math.PI, false);
        ctx.stroke();

        ctx.beginPath();
        ctx.arc(11, 39, 5, 0, 2 * Math.PI, false);
        ctx.stroke();

        ctx.beginPath();
        ctx.arc(39, 39, 5, 0, 2 * Math.PI, false);
        ctx.stroke();
      }
    });
  </script>
</dom-module>
